# 浏览器数字孪生状态覆盖率差距分析

## 概述
当前的 `@twin/chrome` 实现成功地建立了浏览器的**结构拓扑**模型（窗口 Windows、标签页 Tabs、标签组 TabGroups）。然而，它在**内容状态 (Content State)**、**导航上下文 (Navigation Context)** 和 **浏览器子系统 (Browser Subsystems)** 的覆盖上存在缺失。

## 1. 页面内容状态 (部分定义，未同步)
虽然 `types.ts` 中的 `TabExtendedProperties` 定义了部分字段，但目前没有从浏览器扩展同步这些数据的实现。

- **视觉状态**: `zoom` (缩放), `scrollPosition` (滚动位置 - 甚至未定义)。
- **交互状态**: `editable` (可编辑状态), `selection` (选区)。


## 2. 导航上下文 (缺失)
孪生模型知道*当前* URL，但缺乏关于它是如何到达那里的上下文。
- **历史栈**: `canGoBack`, `canGoForward`。这对 Agent 的导航稳定性至关重要。
- **转换类型**: 这是刷新、点击链接还是手动输入的 URL？
- **重定向链**: URL 是否因 301/302 重定向而发生变化？

## 3. 浏览器子系统 (缺失)
浏览器的主要功能区域在孪生状态中完全不存在。
- **网络**: 无法查看挂起的网络请求或失败 (404/500)。
- **Cookie/存储**: 无法查看会话状态。

## 4. 硬件与运行时 (缺失)
- **设备状态**: `online` / `offline` 状态。


## 缺失项汇总
为了完全覆盖“所有运行状态”，应考虑添加以下内容：

### 优先级 1: 导航与稳定性
- [ ] **历史状态**: 在 `TabState` 中添加 `canGoBack`, `canGoForward`。
- [ ] **网络状态**: 在 `SystemState` 中添加 `navigator.onLine` 状态。

### 优先级 2: 丰富的内容交互
- [ ] **缩放同步**: 实现 `zoom` 的同步逻辑。
- [ ] **滚动状态**: 追踪大致的滚动位置 (顶部/中部/底部)。

## 结论
当前的实现更像是一个**“窗口管理器孪生 (Window Manager Twin)”**，而不是完整的**“浏览器实例孪生 (Browser Instance Twin)”**。它非常适合窗口管理任务，但对于需要深度页面交互感知或浏览器配置管理的任务来说是不够的。
