# Stagehand DOM 序列化 - 文档索引

## 概述

本目录包含 Stagehand DOM 序列化功能的完整实现文档，该功能将页面的 DOM 树和可访问性树（Accessibility Tree）合并为统一的快照格式，供 LLM 理解页面结构并进行元素定位。

## 文档列表

| 文档 | 说明 |
|------|------|
| [01-架构概述.md](./01-架构概述.md) | 整体架构、功能介绍、设计思路 |
| [02-数据结构.md](./02-数据结构.md) | 类型定义、数据流、核心接口 |
| [03-核心模块.md](./03-核心模块.md) | 各模块的实现细节和代码说明 |
| [04-API端点.md](./04-API端点.md) | REST API 使用说明和示例 |
| [05-验证结果.md](./05-验证结果.md) | 测试结果和验证数据 |

## 快速导航

### 按需求查找

- **我想了解整体架构** → [01-架构概述.md](./01-架构概述.md)
- **我想了解数据格式** → [02-数据结构.md](./02-数据结构.md)
- **我想了解代码实现** → [03-核心模块.md](./03-核心模块.md)
- **我想调用 API** → [04-API端点.md](./04-API端点.md)
- **我想看验证结果** → [05-验证结果.md](./05-验证结果.md)

## 相关文件路径

### 源代码位置

```
.refer/server/utils/control/
├── driverAdapter.ts           # CDP 方法封装（新增 describeNode、getFrameOwner 等）
└── snapshot/
    ├── index.ts               # 模块导出
    ├── capture.ts             # captureHybridSnapshot 主函数
    ├── domTree.ts             # DOM 树处理
    ├── a11yTree.ts            # 可访问性树处理
    ├── xpathUtils.ts          # XPath 工具函数
    └── treeFormatUtils.ts     # 树格式化工具

.refer/server/routes/control/
├── snapshot.post.ts           # POST /control/snapshot 端点
└── verify/
    └── snapshot.get.ts        # 验证页面
```

### 参考实现

```
.refer/.sources/stagehand/packages/core/lib/v3/understudy/a11y/snapshot/
├── capture.ts                 # Stagehand 原版实现
├── domTree.ts
├── a11yTree.ts
├── xpathUtils.ts
└── treeFormatUtils.ts
```

## 版本信息

- **创建日期**: 2026-01-08
- **基于**: Stagehand v3 captureHybridSnapshot
- **验证状态**: ✅ 全部通过
